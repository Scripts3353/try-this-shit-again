

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ReallyUnb0ck3d</title>
<style>
body { margin:0; font-family: Arial, sans-serif; background:#1e1e2f; color:white; }
header { background:#2e2e4f; padding:30px; text-align:center; position:relative; }
header h1, header h2, header h3 { font-family: "Comic Sans MS", cursive, sans-serif; margin:5px 0; }
header h1 { font-size:3rem; }
header h2 { font-size:1.8rem; display:inline-block; white-space: pre; }
.cursor { display:inline-block; width:.15em; background:orange; animation:blink 0.7s step-start infinite; margin-left:2px; }
@keyframes blink { 0%,50%,100%{ opacity:1 } 25%,75%{ opacity:0 } }

nav { display:flex; justify-content:center; gap:20px; margin-top:20px; }
nav button { background:#4b2e83; border:none; padding:10px 15px; color:white; font-weight:bold; cursor:pointer; border-radius:5px; transition:0.3s; }
nav button:hover { background:#ffcc00; color:#000; }

.game-grid { display:grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap:20px; padding:20px; }
.game-card { background:#2e2e4f; border-radius:10px; overflow:hidden; cursor:pointer; text-align:center; transition:0.3s; box-shadow:0 2px 8px rgba(0,0,0,0.4); }
.game-card img { width:100%; height:150px; object-fit:cover; display:block; }
.game-card h3 { margin:10px 6px; font-size:1rem; }
.game-card:hover { transform: scale(1.03); }

.credits { background:#2e2e4f; padding:20px; border-radius:10px; max-width:900px; margin:20px auto; text-align:center; }

#deviceIdDisplay { position: fixed; top: 10px; left: 10px; font-size: 12px; color: #ffcc00; background: #2e2e4f; padding: 6px 10px; border-radius: 6px; z-index:9999; }
.logout-btn { position: fixed; top: 10px; right: 10px; z-index:9999; padding:8px 12px; border-radius:8px; border:none; background:#9d4edd; color:white; cursor:pointer; font-weight:700; }
.admin-btn { position: fixed; top: 48px; right: 10px; z-index:9999; padding:8px 12px; border-radius:8px; border:none; background:#333; color:white; cursor:pointer; font-weight:700; display:block; }

.admin-panel {
  position: fixed;
  right: 10px;
  top: 100px;
  width: 380px;
  max-height: 70vh;
  overflow:auto;
  background: rgba(0,0,0,0.9);
  padding: 12px;
  border-radius: 10px;
  display:none;
  z-index:10000;
}
.admin-panel h3 { margin:6px 0 10px 0; font-size:16px; }
.input, .small { width:100%; padding:8px; margin:6px 0; border-radius:6px; border:none; background:#1a1a2e; color:#fff; }
.row { display:flex; gap:8px; }
.row button { flex:1; padding:8px; border-radius:6px; border:none; cursor:pointer; }
.btn-danger { background:#ff5555; color:#fff; }
.btn-ok { background:#4caf50; color:#fff; }
.table { width:100%; font-family:monospace; font-size:13px; color:#ddd; margin-top:8px; }
.dev-item { background:#111; padding:8px; margin:6px 0; border-radius:6px; }
.bad { color:#ff8b8b } .good { color:#b7ffb7 }
.note { font-size:12px; color:#ccc; margin-top:6px; }
</style>
</head>
<body>
  <script>
    const localKey = 'deviceLogin';
    const revokeKey = 'revokedDevices';

    let loginData = localStorage.getItem(localKey);
    const revoked = JSON.parse(localStorage.getItem(revokeKey) || '[]');

    if (!loginData) {
        // Device never created -> redirect to login
        window.location.replace('index.html');
    } else {
        loginData = JSON.parse(loginData);
        if (revoked.includes(loginData.deviceId)) {
            // Device revoked -> redirect to login
            alert('Your device has been revoked!');
            window.location.replace('index.html');
        }
    }
  </script>

  <!-- Rest of your body content goes here -->


<script>
// Enforce login at top: ensure deviceLogin exists and not revoked
const loginRaw = localStorage.getItem('deviceLogin');
if (!loginRaw) {
  window.location.replace('index.html');
} else {
  try {
    const login = JSON.parse(loginRaw);
    // check revoked list
    const revokedRaw = localStorage.getItem('revokedDevices') || '[]';
    const revoked = JSON.parse(revokedRaw);
    if (Array.isArray(revoked) && revoked.includes(login.deviceId)) {
      // this device is revoked locally
      alert('This device has been revoked. You will be logged out.');
      localStorage.removeItem('deviceLogin');
      window.location.replace('index.html');
    }
  } catch(e) {
    console.error('login parse error', e);
    localStorage.removeItem('deviceLogin');
    window.location.replace('index.html');
  }
}
</script>

<button class="admin-btn" id="adminBtn" onclick="openAdmin()">Admin Login</button>
<div id="deviceIdDisplay">Device: <span id="deviceIdSpan"></span></div>

<header>
  <h1>ReallyUnb0ck3d</h1>
  <h2 id="animatedHeader"></h2>
  <h3>Site url changed and one of the headers broke</h3>
  <nav>
    <button onclick="openTab('games')">Games</button>
    <button onclick="openTab('credits')">Credits</button>
  </nav>
</header>

<div id="games" class="tab-content active">
  <div class="game-grid">
    <!-- (truncated here in this block for brevity) -->
    <!-- you should paste all your game-card divs here exactly as before -->
<div class="game-card" onclick="location.href='game.html?file=games/COMMENTS.html'">
<img src="https://cdn.jsdelivr.net/gh/gn-math/covers@main/596-uu.png" alt="COMMENTS"><h3>SUGGESTIONS!!</h3></div>
<div class="game-card" onclick="location.href='game.html?file=games/1v1.LoL.html'">
<img src="https://tse1.mm.bing.net/th/id/OIP.jv6iR5gwlta2uwmJ-zoJmgHaHa?rs=1&pid=ImgDetMain&o=7&rm=3" alt="1v1.LoL"><h3>1v1.LoL</h3></div>
<div class="game-card" onclick="location.href='game.html?file=games/2048 Merge Run.html'">
<img src="https://th.bing.com/th/id/OIP.6fTgpyMudOUZtAeJRQ9GEwAAAA?w=147&h=158&c=7&r=0&o=7" alt="2048 Merge Run"><h3>2048 Merge Run</h3></div>
<div class="game-card" onclick="location.href='game.html?file=games/Adventure Capatalist.html'">
<img src="https://th.bing.com/th/id/OIP.cn1P453UfDub7AaFBRoO0gHaHa?w=181&h=182&c=7&r=0&o=7" alt="Adventure Capatalist"><h3>Adventure Capatalist</h3></div>
<div class="game-card" onclick="location.href='game.html?file=games/Basket Random.html'">
<img src="https://th.bing.com/th/id/R.3279f70eec52d7b6c1a4e72021fe9b49?rik=U6kdaNpz86dnyw&pid=ImgRaw&r=0" alt="Basket Random"><h3>Basket Random</h3></div>
<div class="game-card" onclick="location.href='game.html?file=games/Boxing Random.html'">
<img src="https://tse2.mm.bing.net/th/id/OIP.Rt480d2t4SEiajoVvPNxAwAAAA?rs=1&pid=ImgDetMain&o=7&rm=3" alt="Boxing Random"><h3>Boxing Random</h3></div>
<div class="game-card" onclick="location.href='game.html?file=games/Dadish 2.html'">
<img src="https://th.bing.com/th/id/OIP.4zoJ1qn3b0m4BMN4WDqXpwHaHa?w=178&h=180&c=7&r=0&o=7" alt="Dadish 2"><h3>Dadish 2</h3></div>
<div class="game-card" onclick="location.href='game.html?file=games/Dadish 3.html'">
<img src="https://th.bing.com/th/id/OIP.qDULYJ66o1pvZ_X2W3PqXwHaHa?w=159&h=180&c=7&r=0&o=7" alt="Dadish 3"><h3>Dadish 3</h3></div>
<div class="game-card" onclick="location.href='game.html?file=games/Dadish.html'">
<img src="https://th.bing.com/th/id/OIP.dRhGIzN8Wnu1sQKYlyjoygHaHa?w=180&h=180&c=7&r=0&o=7" alt="Dadish"><h3>Dadish</h3></div>
<div class="game-card" onclick="location.href='game.html?file=games/Daily Dadish.html'">
<img src="https://th.bing.com/th/id/OIP.gX7YJ_JbsmnyTMy_ONrHxwHaHa?w=156&h=180&c=7&r=0&o=7" alt="Daily Dadish"><h3>Daily Dadish</h3></div>
<div class="game-card" onclick="location.href='game.html?file=games/Death Run 3D.html'">
<img src="https://play-lh.googleusercontent.com/dEu4Lrs5Ke5ZHDMedRkjjtYq1G22gGccxeIU_ZJNqqwLeSYshuUxBU0KCrSG7lEEwBo" alt="Death Run 3D"><h3>Death Run 3D</h3></div>
<div class="game-card" onclick="location.href='game.html?file=games/Dig Deep.html'">
<img src="https://th.bing.com/th/id/OIP.YUcEfbT0RA-uoutBX-8qiQHaGY?w=212&h=183&c=7&r=0&o=7" alt="Dig Deep"><h3>Dig Deep</h3></div>
<div class="game-card" onclick="location.href='game.html?file=games/Doge Miner.html'">
<img src="https://th.bing.com/th/id/OIP.8qiNzyPViFpETptqypnL4AHaHa?w=167&h=180&c=7&r=0&o=7" alt="Doge Miner"><h3>Doge Miner</h3></div>
<div class="game-card" onclick="location.href='game.html?file=games/Escape Road.html'">
<img src="https://cdn.jsdelivr.net/gh/gn-math/covers@main/264.png" alt="Escape Road"><h3>Escape Road</h3></div>
<div class="game-card" onclick="location.href='game.html?file=games/Flip Master.html'">
<img src="https://cdn.jsdelivr.net/gh/gn-math/covers@main/392.png" alt="Flip Master"><h3>Flip Master</h3></div>
<div class="game-card" onclick="location.href='game.html?file=games/Getting Over It with Bennett Foddy.html'">
<img src="https://th.bing.com/th/id/OIP.DoF8lVpkK92j9OnNye__rQHaEK?w=313&h=180&c=7&r=0&o=7" alt="Getting Over It with Bennett Foddy"><h3>Getting Over It with Bennett Foddy</h3></div>
<div class="game-card" onclick="location.href='game.html?file=games/MonkeyMart.html'">
<img src="https://th.bing.com/th/id/OIP.GmKIjCrlse8QXE9EB8175gHaHa?w=180&h=180&c=7&r=0&o=7" alt="MonkeyMart"><h3>MonkeyMart</h3></div>
<div class="game-card" onclick="location.href='game.html?file=games/Pac-Man Superfast.html'">
<img src="https://th.bing.com/th/id/OIP.WYvgl82DmC7P4Pdyf2KddQHaEK?w=288&h=180&c=7&r=0&o=7" alt="Pac-Man Superfast"><h3>Pac-Man Superfast</h3></div>
<div class="game-card" onclick="location.href='game.html?file=games/Ragdoll Archers.html'">
<img src="https://cdn.jsdelivr.net/gh/gn-math/covers@main/186.png" alt="Ragdoll Archers"><h3>Ragdoll Archers</h3></div>
<div class="game-card" onclick="location.href='game.html?file=games/Retro Bowl.html'">
<img src="https://cdn.jsdelivr.net/gh/gn-math/covers@main/33.png" alt="Retro Bowl"><h3>Retro Bowl</h3></div>
<div class="game-card" onclick="location.href='game.html?file=games/Slope 2.html'">
<img src="https://cdn.jsdelivr.net/gh/gn-math/covers@main/368.png" alt="Slope 2"><h3>Slope 2</h3></div>
<div class="game-card" onclick="location.href='game.html?file=games/SolarSandbox.html'">
<img src="https://solarsmash.co/data/image/game/solar-sandbox/solar-sandbox.jpg" alt="SolarSandbox"><h3>SolarSandbox</h3></div>
<div class="game-card" onclick="location.href='game.html?file=games/Twerk Race 3D.html'">
<img src="https://th.bing.com/th/id/OIP.tAYNPAIEKwy5Eb_3qw-ckQHaHa?w=187&h=187&c=7&r=0&o=7" alt="Twerk Race 3D"><h3>Twerk Race 3D</h3></div>
<div class="game-card" onclick="location.href='game.html?file=games/Wordle.html'">
<img src="https://th.bing.com/th/id/OIP.NhkcU9EZ3tvwdVo6db0bgAHaHa?w=173&h=180&c=7&r=0&o=7" alt="Wordle"><h3>Wordle</h3></div>
<div class="game-card" onclick="location.href='game.html?file=games/coreball.html'">
<img src="https://th.bing.com/th/id/OIP.pSaFRh5UZ-PZi9oqxGDZfgHaFj?w=213&h=180&c=7&r=0&o=7" alt="Core Ball"><h3>Core Ball</h3></div>
<div class="game-card" onclick="location.href='game.html?file=games/crazycars.html'">
<img src="https://th.bing.com/th/id/OIP.9Y7-6QtaVAYoyrFFjzUbIgHaHa?w=179&h=180&c=7&r=0&o=7" alt="Crazy Cars"><h3>Crazy Cars</h3></div>
<div class="game-card" onclick="location.href='game.html?file=games/snowrider.html'">
<img src="https://th.bing.com/th/id/OIP.HEucI3p7n0YYCVzhNm_VxgAAAA?w=152&h=180&c=7&r=0&o=7" alt="Snow Rider 3D"><h3>Snow Rider 3D</h3></div>
<div class="game-card" onclick="location.href='game.html?file=games/CozyGolf.html'">
<img src="https://i.imgur.com/1FwIG8m_d.webp?maxwidth=760&fidelity=grand" alt="CozyGolf"><h3>Cozy Golf (Not Working)</h3></div>
<div class="game-card" onclick="location.href='game.html?file=games/madden64.html'">
<img src="https://tse3.mm.bing.net/th/id/OIP.5zkP8SuHwTsaqw902v9MMgHaFI?w=264&h=182&c=7&r=0&o=7" alt="madden64"><h3>madden64</h3></div>
<div class="game-card" onclick="location.href='game.html?file=games/trafficjam3d.html'">
<img src="https://th.bing.com/th/id/OIP.B4Z_VL6Af0CDW_fsd6XEJQHaDt?w=327&h=174&c=7&r=0&o=7" alt="Traffic Jam 3D"><h3>Traffic Jam 3D</h3></div>
<div class="game-card" onclick="location.href='game.html?file=games/shrek2.html'">
<img src="https://tse2.mm.bing.net/th/id/OIP.7QbssIaRBRko9p_g6GPaKQHaHa?w=166&h=180&c=7&r=0&o=7" alt="shrek2"><h3>shrek2</h3></div>
<div class="game-card" onclick="location.href='game.html?file=games/Growden.io.html'">
<img src="https://tse3.mm.bing.net/th/id/OIP.YPqwQpuLpH9jWJLIHyFPigHaEK?rs=1&pid=ImgDetMain&o=7&rm=3" alt="Growden"><h3>Growden.io</h3></div>
<div class="game-card" onclick="location.href='game.html?file=games/99Nights.html'">
<img src="https://th.bing.com/th/id/OIP.A75lKs2UsoiL7GAEofMIAwHaEK?w=309&h=180&c=7&r=0&o=7" alt="99Nights"><h3>99 Nights In A forest</h3></div>
<div class="game-card" onclick="location.href='game.html?file=games/capybaraclicker.html'">
<img src="https://th.bing.com/th/id/OIP._yNwNBn69lZ6ZRdEB6BPIAHaD4?w=312&h=200&c=12&rs=1&o=6&pid=23.1" alt="Capybaraclicker"><h3>Capybara Clicker</h3></div>
<div class="game-card" onclick="location.href='game.html?file=games/GrannyOnline.html'">
<img src="https://th.bing.com/th/id/OIP.GIeeOy3l0WRqKRsOQxOMeQHaD4?w=327&h=180&c=7&r=0&o=7" alt="GrannyOnline"><h3>Granny ONLINE</h3></div>
<div class="game-card" onclick="location.href='game.html?file=games/SubwayMiami.html'">
<img src="https://th.bing.com/th/id/OIP.3R42Bb5kvmhye2v7dmprswHaEK?w=287&h=180&c=7&r=0&o=7" alt="SubMiami"><h3>Subway Surfers Miami</h3></div>
<div class="game-card" onclick="location.href='game.html?file=games/BankRobbery2.html'">
<img src="https://th.bing.com/th/id/OIP.mrcQ0lI2QeiWcvI-KKajWgHaHa?w=172&h=180&c=7&r=0&o=7" alt="BankRobbery2"><h3>Bank Robbery 2</h3></div>
<div class="game-card" onclick="location.href='game.html?file=games/PeoplePlayground.html'">
<img src="https://cdn.jsdelivr.net/gh/gn-math/covers@main/194.png" alt="PeoplePlayground"><h3>People Playground</h3></div>
<div class="game-card" onclick="location.href='game.html?file=games/Tomb.html'">
<img src="https://cdn.jsdelivr.net/gh/gn-math/covers@main/109.png" alt="Tomb"><h3>Tomb Of The Mask</h3></div>
<div class="game-card" onclick="location.href='game.html?file=games/BrawlGuys.io.html'">
<img src="https://cdn.jsdelivr.net/gh/gn-math/covers@main/121.png" alt="BrawlGuys.io"><h3>Brawl Guys.io</h3></div>
<div class="game-card" onclick="location.href='game.html?file=games/Kindergarten.html'">
<img src="https://cdn.jsdelivr.net/gh/gn-math/covers@main/445.png" alt="Kindergarten"><h3>Kindergarten 1</h3></div>
<div class="game-card" onclick="location.href='game.html?file=games/Kindergarten2.html'">
<img src="https://cdn.jsdelivr.net/gh/gn-math/covers@main/446.png" alt="Kindergarten2"><h3>Kindergarten 2</h3></div>
<div class="game-card" onclick="location.href='game.html?file=games/EXE.html'">
<img src="https://cdn.jsdelivr.net/gh/gn-math/covers@main/606.png" alt="EXE"><h3>Sonic.Exe</h3></div>
<div class="game-card" onclick="location.href='game.html?file=games/DuckLife.html'">
<img src="https://cdn.jsdelivr.net/gh/gn-math/covers@main/234.png" alt="DuckLife"><h3>Duck Life</h3></div>
<div class="game-card" onclick="location.href='game.html?file=games/Uphill Rush.html'">
<img src="https://th.bing.com/th/id/OIP.uZzx4x4ZAK2doT4ibkRihgHaHa?w=180&h=180&c=7&r=0&o=7" alt="Uphill Rush"><h3>Uphill Rush</h3></div>
<div class="game-card" onclick="location.href='game.html?file=games/Ultimate Flash Sonic.html'">
<img src="https://th.bing.com/th/id/OIP.qoxpREZyP9x_RYB6nOa3WgHaEK?w=262&h=180&c=7&r=0&o=7" alt="Ultimate Flash Sonic"><h3>Ultimate Flash Sonic</h3></div>

  </div>
</div>



<!-- Admin Panel -->
<div id="adminPanel" class="admin-panel">
  <h3>Admin — Manage Device Access</h3>

  <div id="adminLoginArea">
    <input id="adminUser" class="input" placeholder="Admin username">
    <input id="adminPass" class="input" placeholder="Admin password" type="password">
    <div class="row">
      <button id="adminLoginBtn" class="btn-ok">Login as Admin</button>
      <button id="adminCancelBtn" class="btn-danger">Cancel</button>
    </div>
    <div class="note">Admin login is <strong>Private and only for lukas</strong>. This is ran on localstorage crap and this allows me to revoke your access.</div>
  </div>

  <div id="adminUI" style="display:none;">
    <div class="note">Known devices (from this browser's <code>publicDevices</code>)</div>
    <div id="devicesList"></div>

    <div style="margin-top:8px;">
      <input id="manualDeviceId" class="input" placeholder="Paste device ID to revoke / grant">
      <div class="row">
        <button id="revokeBtn" class="btn-danger">Revoke</button>
        <button id="grantBtn" class="btn-ok">Grant</button>
      </div>
    </div>

    <div style="margin-top:10px;">
      <div class="row">
        <button id="refreshBtn" class="btn-ok">Refresh Selected Device ID</button>
        <button id="deleteDeviceBtn" class="btn-danger">Delete Selected Device Entry</button>
      </div>
    </div>

    <div style="margin-top:10px;">
      <div class="note">Revoked devices list (localStorage)</div>
      <div id="revokedList" class="table"></div>
    </div>

    <div style="margin-top:8px;">
      <button id="adminLogoutBtn" class="btn-danger">Logout Admin</button>
    </div>
    <div class="note" style="margin-top:8px">Note: these operations are local to this browser/profile. To revoke other users in other browsers you need a central server.</div>
  </div>
</div>

<script>
// helper keys
const PUBLIC_KEY = 'publicDevices';
const REVOKE_KEY = 'revokedDevices';
const ADMIN_USER = 'lukas';
const ADMIN_PASS = 'lukas';

// show device id
try {
  const login = JSON.parse(localStorage.getItem('deviceLogin'));
  if (login && login.deviceId) document.getElementById('deviceIdSpan').textContent = login.deviceId;
} catch(e){ console.error(e); }

// Tab switching (basic)
function openTab(id){
  document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
  const el = document.getElementById(id);
  if (el) el.classList.add('active');
}

// logout
function logout(){
  localStorage.removeItem('deviceLogin');
  window.location.replace('index.html');
}

// ADMIN panel logic
const adminPanel = document.getElementById('adminPanel');
const adminUI = document.getElementById('adminUI');
const adminLoginArea = document.getElementById('adminLoginArea');
const adminLoginBtn = document.getElementById('adminLoginBtn');
const adminCancelBtn = document.getElementById('adminCancelBtn');
const adminLogoutBtn = document.getElementById('adminLogoutBtn');
const devicesListDiv = document.getElementById('devicesList');
const revokedListDiv = document.getElementById('revokedList');

function openAdmin(){
  adminPanel.style.display = 'block';
  adminLoginArea.style.display = 'block';
  adminUI.style.display = 'none';
  document.getElementById('adminUser').value = '';
  document.getElementById('adminPass').value = '';
}

adminCancelBtn.addEventListener('click', ()=>{
  adminPanel.style.display = 'none';
});

adminLoginBtn.addEventListener('click', ()=>{
  const u = document.getElementById('adminUser').value.trim();
  const p = document.getElementById('adminPass').value.trim();
  if (u === ADMIN_USER && p === ADMIN_PASS) {
    adminLoginArea.style.display = 'none';
    adminUI.style.display = 'block';
    renderDevices();
    renderRevoked();
  } else {
    alert('Admin login failed');
  }
});

adminLogoutBtn.addEventListener('click', ()=>{
  adminPanel.style.display = 'none';
  adminLoginArea.style.display = 'block';
  adminUI.style.display = 'none';
});

// utility: read & write public devices (local list created when index generates)
function getPublicDevices(){
  try { return JSON.parse(localStorage.getItem(PUBLIC_KEY) || '[]'); }
  catch(e){ return []; }
}
function setPublicDevices(arr){ localStorage.setItem(PUBLIC_KEY, JSON.stringify(arr)); }

// utility: revoked devices
function getRevoked(){ try { return JSON.parse(localStorage.getItem(REVOKE_KEY) || '[]'); } catch(e){ return []; } }
function setRevoked(arr){ localStorage.setItem(REVOKE_KEY, JSON.stringify(arr)); }

function renderDevices(){
  const list = getPublicDevices();
  if (!list.length){ devicesListDiv.innerHTML = '<div class="note">No known devices stored in this browser (publicDevices empty).</div>'; return; }
  devicesListDiv.innerHTML = '';
  list.forEach(d=>{
    const div = document.createElement('div');
    div.className = 'dev-item';
    const used = getRevoked().includes(d.deviceId) ? '<span class="bad">REVOKED</span>' : '<span class="good">ACTIVE</span>';
    div.innerHTML = `<div><strong>${d.username}</strong> · ${d.deviceId} · <small>${new Date(d.createdAt).toLocaleString()}</small></div>
                     <div style="margin-top:6px">${used}</div>
                     <div style="margin-top:6px"><button onclick="selectDevice('${d.deviceId}')" style="padding:6px;border-radius:6px;border:none;cursor:pointer">Select</button></div>`;
    devicesListDiv.appendChild(div);
  });
}

let selectedDeviceId = null;
function selectDevice(id){
  selectedDeviceId = id;
  document.getElementById('manualDeviceId').value = id;
  alert('Selected device: ' + id);
}

document.getElementById('revokeBtn').addEventListener('click', ()=>{
  const id = document.getElementById('manualDeviceId').value.trim();
  if(!id){ alert('Enter device ID'); return; }
  const revoked = getRevoked();
  if (revoked.includes(id)){ alert('Already revoked'); return; }
  revoked.push(id);
  setRevoked(revoked);
  renderRevoked();
  alert('Device revoked locally: ' + id);
  // if the admin revoked the current device, immediately log it out
  const current = JSON.parse(localStorage.getItem('deviceLogin')||'{}');
  if (current.deviceId === id){ alert('You revoked this device. Logging out.'); localStorage.removeItem('deviceLogin'); window.location.replace('index.html'); }
});

document.getElementById('grantBtn').addEventListener('click', ()=>{
  const id = document.getElementById('manualDeviceId').value.trim();
  if(!id){ alert('Enter device ID'); return; }
  let revoked = getRevoked();
  revoked = revoked.filter(x => x !== id);
  setRevoked(revoked);
  renderRevoked();
  alert('Device granted (removed from revoked): ' + id);
});

document.getElementById('refreshBtn').addEventListener('click', ()=>{
  const id = document.getElementById('manualDeviceId').value.trim();
  if(!id){ alert('Enter device ID'); return; }
  // find device in public devices
  const list = getPublicDevices();
  const idx = list.findIndex(d => d.deviceId === id);
  if (idx === -1){ alert('Device entry not found in publicDevices'); return; }
  const newId = 'dev-' + Math.random().toString(36).slice(2,10);
  list[idx].deviceId = newId;
  // if this browser's current device matches old id, update current device as well
  const current = JSON.parse(localStorage.getItem('deviceLogin')||'{}');
  if (current.deviceId === id) {
    current.deviceId = newId;
    localStorage.setItem('deviceLogin', JSON.stringify(current));
    document.getElementById('deviceIdSpan').textContent = newId;
  }
  setPublicDevices(list);
  renderDevices();
  alert('Refreshed device id. New: ' + newId);
});

document.getElementById('deleteDeviceBtn').addEventListener('click', ()=>{
  const id = document.getElementById('manualDeviceId').value.trim();
  if(!id){ alert('Enter device ID'); return; }
  let list = getPublicDevices();
  list = list.filter(d => d.deviceId !== id);
  setPublicDevices(list);
  renderDevices();
  alert('Deleted device entry: ' + id);
});

function renderRevoked(){
  const arr = getRevoked();
  if (!arr.length) revokedListDiv.innerHTML = '<div class="note">No revoked device IDs</div>';
  else revokedListDiv.innerHTML = arr.map(v => `<div style="padding:6px;background:#111;margin:6px 0;border-radius:6px">${v}</div>`).join('');
}

// Initialize admin UI with current values if admin already logged in
// (none by default)
renderRevoked();
</script>
</body>
</html>
