<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Admin Panel</title>
<style>
body {
  background: linear-gradient(135deg, #2d004d, #10001a);
  color: white;
  font-family: Arial, sans-serif;
  display: flex;
  flex-direction: column;
  align-items: center;
  min-height: 100vh;
  padding: 40px;
}
h2 {
  color: #a855f7;
}
#login-box, #admin-panel {
  background: rgba(255, 255, 255, 0.1);
  padding: 20px 30px;
  border-radius: 10px;
  box-shadow: 0 0 20px rgba(0,0,0,0.5);
}
input {
  padding: 8px;
  border-radius: 5px;
  border: none;
  margin: 5px;
}
button {
  background: #7e22ce;
  border: none;
  color: white;
  padding: 8px 16px;
  border-radius: 5px;
  cursor: pointer;
  transition: 0.2s;
}
button:hover {
  background: #a855f7;
}
.device {
  margin: 8px 0;
  padding: 8px 12px;
  border-radius: 6px;
  width: 100%;
  display: flex;
  justify-content: space-between;
  align-items: center;
}
.device.active {
  background: rgba(0, 255, 0, 0.15);
}
.device.revoked {
  background: rgba(255, 0, 0, 0.2);
}
</style>
</head>
<body>
<h2>Admin Login</h2>

<div id="login-box">
  <input type="text" id="user" placeholder="Username" /><br />
  <input type="password" id="pass" placeholder="Password" /><br />
  <button onclick="adminLogin()">Login</button>
</div>

<div id="admin-panel" style="display:none;">
  <h2>Device Manager</h2>
  <div id="device-list"></div>
  <button onclick="logout()">Logout</button>
</div>

<script>
const ADMIN_USER = "lukas";
const ADMIN_PASS = "lukas";
const DEVICE_KEY = "deviceLogin";
const REVOKED_KEY = "revokedDevices";

function adminLogin() {
  const user = document.getElementById("user").value.trim();
  const pass = document.getElementById("pass").value.trim();
  if (user === ADMIN_USER && pass === ADMIN_PASS) {
    document.getElementById("login-box").style.display = "none";
    document.getElementById("admin-panel").style.display = "block";
    loadDevices();
  } else {
    alert("Invalid login");
  }
}

function logout() {
  document.getElementById("admin-panel").style.display = "none";
  document.getElementById("login-box").style.display = "block";
}

function loadDevices() {
  const revoked = JSON.parse(localStorage.getItem(REVOKED_KEY) || "[]");
  const thisDevice = JSON.parse(localStorage.getItem(DEVICE_KEY) || "null");
  const list = document.getElementById("device-list");
  list.innerHTML = "";

  // For demo: show current device
  if (thisDevice) {
    const div = document.createElement("div");
    div.className = "device " + (revoked.includes(thisDevice.id) ? "revoked" : "active");
    div.innerHTML = `
      <span>${thisDevice.id}</span>
      <button onclick="toggleRevoke('${thisDevice.id}')">${
      revoked.includes(thisDevice.id) ? "Unrevoke" : "Revoke"
    }</button>
    `;
    list.appendChild(div);
  } else {
    list.innerHTML = "<p>No device IDs found.</p>";
  }
}

function toggleRevoke(id) {
  let revoked = JSON.parse(localStorage.getItem(REVOKED_KEY) || "[]");
  if (revoked.includes(id)) {
    revoked = revoked.filter((d) => d !== id);
  } else {
    revoked.push(id);
  }
  localStorage.setItem(REVOKED_KEY, JSON.stringify(revoked));
  loadDevices();
}
</script>
</body>
</html>
